# Database System

## 데이터 베이스 시스템의 정의

데이터 베이스 시스템은 데이터베이스에 데이터를 저장하고, 저장된 데이터를 관리하여 조직에 필요한 정보를 생성해주는 시스템이다. 따라서 다양한 목적의 정보처리 시스템을 구축하는데 필요한 핵심 요소가 된다.

흔히 데이터베이스, 데이터베이스 관리 시스템, 데이터베이스 시스템을 같은 용어로 사용하지만 각용어의 개념을 명확하게 할 필요가 있다. 데이터를 저장해두는곳 다시 말해서 데이터의 집합이 데이터베이스다. 데이터베이스 관리 시스템은 데이터베이스에 저장된 데이터가 일관되고 무결한 상태로 유지되도록 관리하는 역할을 한다. 그리고 데이터베이스 시스템은 데이터베이스와 데이터베이스 관리 시스템을 이용해 조직에 필요한 정보를 제공해주는 전체 시스템이다. 데이터베이스와 데이터베이스 관리 시스템은 데이터베이스 시스템의 핵심 구성 요소이다. 데이터베이스 시스템은 사용자, 사용자가 데이터베이스에 접근할 때 사용하는 데이터 언어, 데이터베이스와 데이터베이스 관리 시스템을 설치하고 데이터 처리 연산을 담당하는 컴퓨터로 구성된다.

## 데이터베이스의 구조

> 1. 스키마 : 스키마는 데이터베이스에 저장되는 데이터 구조와 제약조건을 정의한것이다. 정의된 스키마에 따라 데이터베이스에 실제로 저장된 값이 인스턴스이다. 보통 스키마는 한번 정의되면 자주 변경되지 않지만, 인스턴스는 계속 변하는 특성이 있다.
> 2. 3단계 데이터베이스 구조
>    데이터베이스의 내부 구조및 동작 방식을 모둥 이해하고 있어야한다면 일반 사용자에게 데이터베이스는 그림의 떡일 수 밖에없다. 미국의 표준화 기관인 ANSI/SPARC 에서는 데이터베이스의 복잡한 내구조를 감추고 데이터베이스를 쉽게 이해하고 사용할 수 있도록 3단계 데이터베이스 구조를 제안했다. 이는 하나의 데이터베이스를 세단계로 나누어 이해한다. 즉 개별 사용자 관점에서 바라보는 외부 단계, 조직 전체의 관점에서 바라보는 개념단계, 물리적인 저장장치의 관점에서 바라보는 내부 단계로 나눈다. 데이터베이스 하나를 세 단계로 나누고, 각 단계별로 다른 추상화를 제공하면 데이터베이스를 효과적으로 관리할 수 있다. 일반적으로 내부 단계에서 외부단계로 갈수록 추상화 레벨이 높아진다.
>    **외부 단계**: 개별 사용자 관점에서 데이터베이스를 이해하고 표현한다. 하나의 데이터베이스를 조직 내의 사용자들이 함께 사용하지만 각 사용자가 데이터베이스 전체에 관심이 있는 것은 아니다. 사용자마다 업무 내용과 사용목적이 달라 필요한 데이터 내용이 다를 수 있다. 예를 들어 쇼핑몰을 운영하기 위해 필요한 데이터베이스에는 고객, 상품, 직원, 주문등과 관련한 데이터들이 존재할 것이다. 그러면 사용자 가운데 고객 관리를 담당하는 직원은 데이터베이스에서 고객과 관련된 데이터에만, 상품관리를 담당하는 직원은 상품과관련된 데이터에만 관심을 가질 것이다. 이처럼 외부 단계에서 사용자에게 필요한 데이터베이스를 정의한 것을 외부 스키마라고 한다. 외부 스키마는 각 사용자가 생각하는 데이터베이스의 모습을 표현한 논리적인 구조로 사용자마다 다르다. 데이터베이스 하나에는 외부 스키마가 여러개 존재할 수 있고, 외부 스키마 하나를 사용 목적이 같은 사용자들이 공유할 수 있다. 외부 스키마는 전체 데이터베이스 중 사용자가 관심을 가지는 일부분으로 볼 수 있어 서브 스키마라고도 한다.
>    **개념 단계**: 데이터베이스를 이용하는 사용자들의 관점을 통합하여, 데이터베이스를 조직 전ㅌ체의 관점에서 이해하고 표현한다. 데이터베이스 관리 시스템이나 데이터베이스 관리자는 데이터베이스의 일부분이 아닌 전체 데이터베이스에 관심을 둔다. 개념 단계에서는 이 같은 데이터베이스 관리 시스템이나 관리자의 관점에서 모든 사용자에게 필요한 데이터를 통합하여 전체 데이터베이스의 논리적 구조를 정의한다. 이를 개념 스키마라고 한다.
>    개념 스키마는 조직 전체의 관점에서 생각하는 데이터베이스의 모습이며, 모든 개별 사용자가 생각하는 데이터베이스의 모습을 하나로 합친 형태이다. 개념 스키마는 전체 데이터베이스에 어떤 데이터가 저장되는지, 데이터들 간에는 어떤 관계가 존재하고 어떤 제약 조건이 있는지에 대한 정의뿐만 아니라, 데이터에 대한 보안 정책이나 접근 권한에 대한 정의도 포함한다. 하지만 데이터를 물리적으로 저장하는 방법이나 데이터 저장장치와는 독립적이다. 데이터베이스 하나에는 개념스키마가 하나만 존재하고, 각 사용자는 개념 스키마의 일부분을 사용한다. 즉 일부 스키마는 개념스키마를 기초로 하여 사용자의 이용 목적에 맞게 만들어진다. 일반적으로 스키마라고 하면 개념 스키마를 의미한다.
>    **내부 단계** : 내부 단계에서는 데이터베이스를 디스크나 테이프 같은 저장 장치의 관점에서 이해하고 표현한다. 즉 내부 단계에서는 전체 데이터베이스가 저장 장치에 실제로 저장되는 방법을 정의하며 이를 내부 스키마라고 한다. 데이터베이스는 저장 장치에 파일 형태로 저장되는데 내부 스키마는 파일에 데이터를 저장하는 레코드의 구조, 레코드를 구성하는 필드의 크기, 인덱스를 이용한 레코드 접근 경로 등을 정의한다. 내부 스키마는 데이터베이스의 개념 스키마에 대한 물리적인 저장 구조를 표현하므로 하나의 데이터베이스에 하나만 의존한다.
>    외부 단계는 사용자별로 외부 스키마를 정의하여 불필요한 데이터 접근을 사전에 막아 보안 측면에서도 효과적이다.
>    개념 단계에는 고객 데이터베이스 전체에 대한 논리적 구조를 정의하는 개념 스키마가 하나 존재한다. 개념 스키마는 고객 데이터베이스를 이용하는 모든 사용자에게 필요한 데이터를 종합하여 번호,이름,성별,나이,...등으로 데이터베이스를 구성하고 각 데이터의 타입도 함께 정의한다. 내부 단계에서는 고객 데이터베이스를 저장장치에 저장하는 파일의 레코드 구조를 정의한 내부 스키마가 하나 존재한다. 이 내부 스키마는 특정 필드에 인덱스를 정의하고 있어, 필드의 값을 이용해 해당 고객 레코드에 빠르게 접근할 수 있다.

### 데이터 독립성

하나의 데이터베이스에는 세가지 유형의 스키마가 존재하지만, 각각의 싀마는 데이터베이스를 바라보는 관점이 다를 뿐 모두 같은 데이터베이스를 표현한다. 실제 데이터는 물리적 저장 장치에 저장된 데이터베이스에만 존재하므로 사용자가 자신의 외부 스키마를 통해 원하는 데이터를 얻으려면 내부 스키마에 따라 저장된 데이터베이스에 접근해야한다. 그러므로 세가지 스키마 사이에 유기적인 대응 관계가 성립해야한다.
스키마 사이의 대응 관계를 사상 또는 매핑이라고 한다. 외부 스키마가와 개념 스키마는 외부/개념 사상에 의해 대응되고, 개념 스키마와 내부 스키마는 개념/내부 사상에 의해 대응된다. 데이터베이스 관리 시스템은 미리 정의된 외부.개념 사상과 개념/내부 사상 정보를 이용해 사용자가 원하는 데이터에 접근할 수 있다.

데이터베이스를 3단계 구조로 나누고, 단계별로 스키마를 유지하며 스키마 사이의 대응관계를 정의하는 궁극적인 목적은 데이터 독립성을 실현하기 위해서이다. 데이터 독립성은 데이터베이스 관리 시스템의 중요한 장점이자 데이터베이스 관리 시스템이 필요한 이유이기도 하다. 데이터 독립성은 하위 스키마를 변경하더라도 상위 스키마가 영향을 받지 않는 특성이다.

> **논리적 데이터 독립성**
> 논리적 데이터 독립성은 개념 스키마가 변경되더라도 외부 스키마가 영향을 받지 않는 것이다. 외부/개념 사상은 외부 스키마와 개념 스키마의 대응관계를 정의한 것으로, 응용 인터페이스라고도 한다.개념 스키마가 변경되어도 외부 스키마가 영향을 받지 않는다는 것은 결국 외부 스키마의 사용자가 전체 데이터베이스의 논리적 구조가 변경되었다는 사실을 알 필요가 없음을 의미한다.
> **물리적 데이터 독립성**
> 물리적 데이터 독립성은 내부 스키마가 변경되더라도 개념 스키마가 영향을 받지 않는다는 것이다. 그래서 결과적으로 외부 스키마도 영향을 받지 않는다.
> 데이터베이스 저장 구조가 바뀌어도 관련된 개념/내부 사상 정보만 적절히 수정해주면 직접적으로 관련이 없는 데이터베이스의 논리적 구조는 영향을 받지 않는다. 개념/내부 사상은 개념 스키마와 내부 스키마의 대응 관계를 정의한 것으로 저장 인터페이스라고도 한다.

### 데이터 사전

데이터베이스는 조직 운영을 위해 필요한 데이터를 저장하는데 저장된 데이터를 올바르게 관리하고 이용하려면 필요한 부가정보도 저장해야한다. 대표적인 부가 정보가 스키마와 사상 정보이다.

데이터 독립성을 실현하면서 데이터베이스를 다양한 관점에서 이해하기 위해서는 정의되는 세가지 스키마에 대한 정보와 스키마 간의 사상 정보도 어딘가에 저장되어 있어야 필요할 때 사용할 수 있다. 데이터베이스에 저장되는 데이터에 관한 정보를 저장하는 곳을 데이터 사전 또는 시스템 카탈로그라고 한다. 데이터 사전은 일반 사전처럼 데이터베이스에 저장되어 있는 데이터를 정확하고 효율적으로 이용하기 위해 참고해야되는 스키마, 사상정보, 다양한 제약조건을 저장하고 있다. 데이터베이스에 저장되는 데이터에 관한 정보이므로 데이터에 대한 데이터를 의미해 메타 데이터라고도 한다.

데이터 사전도 데이터를 저장하는 데이터베이스의 일종이기 때문에 시스템 데이터베이스라고도 한다. 그리고 이와 구별하기 위해 사용자가 실제로 이용하는 데이터가 저장되는 일반 데이터베이스를 사용자 데이터베이스라고 한다. 데이터 사전은 데이터베이스 관리 시스템이 스스로 생성하고 유지하는 것으로 데이터베이스 관리 시스템이 주로 접근하지만 일반 사용자도 접근할 수 있다. 단 데이터베이스 관리 시스템이 데이터 사전에 내용을 새로 추가하거나 수정할 수 있는 반면, 사용자는 저장 내용을 검색만 할 수 있다. 데이터 사전에 있는 데이터에 실제로 접근하는데 필요한 위치 정보는 데이터 디렉터리라는 곳에서 관리하낟. 데이터 사전과 데이터 디렉터리는 둘다 시스템을 위한 데이터베이스라는 공통점이 있지만, 데이터 사전은 사용자가 접근할 수 있고 데이터 디렉터리는 시스템만 접근할 수 있다는 차이가 있다.

## 데이터베이스 사용자

사용자는 데이터베이스를 이용하기 위해 접근하는 모든 사람을 말한다. 데이터베이스를 이용하는 사용자는 매우 다양한데, 이용 목적에 따라 크게 데이터베이스 관리자, 최종 사용자, 응용프로그래머로 나뉠 수 있다.

> **데이터 베이스 관리자**
> 관리자는 데이터베이스 시스템을 운영및 관리한다. 데이터베이스를 직접 활용하기 보다는 조직 내의 사용자를 위해 데이터베이스를 설계 및 구축하고, 제대로 서비스할 수 있도록 데이터베이스를 제어한다.
>
> - 데이터베이스 구성 요소 선정
> - 데이터베이스 스키마 정의
>
> - 물리적 저장 구조와 접근 방법 결정
>
> - 무결성 유지를 위한 제약조건 정의
>
> - 보안 및 접근 권한 정책 결정
>
> - 백업 및 회복 기법 정의
>
> - 시스템 데이터베이스 관리
>
> - 시스템 성능 감시 및 성능 분석
>
> - 데이터 베이스 재구성
>
> **최종 사용자**
> 데이터를 조작하기 위해 데이터베이스에 접근하는 사람들을 일반 사용자 또는 최종 사용자라고 한다. 최종 사용자는 캐주얼 사용자와 초보 사용자로 구분할 수 있다.캐주얼 사용자는 데이터베이스에 대한 이론적 지식이 있으며 주로 데이터 조작어를 이용해 원하는 데이터와 데이터에 대한 처리를 데이터베이스 관리시스템에 직접 설명합니다. 초보 사용자는 데이터베이스를 초보 수준으로 사용할 수 있어 데이터 조작어로 자신의 요구를 직접 표현하기 보다는 GUI 형태의 응용 프로그램을 통해 데이터베이스를 사용한다.
> **응용 프로그래머**
> 응용 프로그래머는 C,java,python 등과 같은 프로그래밍 언어로 응용 프로그램을 작성할 때 데이터베이스에 접근하는 데이터 조작어를 삽입하는 사용자이다.

## 데이터 언어

데이터베이스에서 사용자를 대신해 데이터베이스를 구축하고 활용및 관리하는 데이터베이스 관리 시스템에 부탁할 때 사용하는 언어가 있다. 바로 데이터 언어이다. 데이터 언어는 사용자가 데이터 베이스를 구축하고 이에 접근하기 위해 데이터베이스 관리 시스템과 통신하는 수단이기 때문에 사용 목적에 따라 데이터정의, 조작,제어어로 나뉜다. 이는 하나의 데이터 언어를 기능에 따라 내부적으로 구분 짓는 것일 뿐 독립적으로 존재하는 언어들은 아니다.

**DDL (Data Definition Language)**
데이터 정의어는 새로운 데이터베이스를 구축하기 위해 스키마를 정의하거나 기존 스키마의 정의를 삭제 또는 수정하기 위해 사용하는 데이터 언어이다. 데이터 정의어로 정의된 스키마는 데이터 사전에 저장되고, 삭제나 수정이 발생하면 이 내용도 데이터 사전에 반영된다. 데이터 사전에 저장된 스키마 정보는 사용자나 데이터베이스 관리 시스템이 필요할 때 참고 할 수 있다.

**DML (Data Manipulation Language)**
데이터 조작어는 사용자가 데이터의 삽입삭제수정검색등의 처리를 데이터베이스 관리 시스템에 요구하기 위해 사용하는 데이터 언어이다. 데이터 정의어를 이용해 스키마를 정의하면 스키마에 따라 조직에 필요한 실제 데이터 값이 저장되는데, 사용자가 실제 데이터값을 활용하기 위해 사용하는 것이 데이터 조작어다. 데이터 조작어는 설명 방식에 따라 절차적 데이터 조작어와 비절차적 데이터 조작어로 나뉜다.

- 절차적 데이터 조작어는 사용자가 어떤 데이터를 원하고 해당 데이터를 얻으려면 어떻게 처리해야하는지를 설명한다.
- 비절차적 데이터 조작어는 사용자가 어떤 데이터를 원하는지만 설명한다. 즉 해당 데이터를 얻으려면 어떻게 처리해야하는지는 데이터베이스 관리시스템에 맡긴다. 비절차적 데이터 조작어는 사용자가 어떤 데이터를 원하는지만 데이터베이스 관리 시스템에 선언하는 방식이기 때문에 선언적 언어라고도 한다.

**DCL (Data Control Language)**
데이터 제어어는 데이터베이스에 저장된 데이터를 여러 사용자가 무결성과 일관성을 유지하며 문제가 없이 공유할 수 있도록, 내부적으로 필요한 규칙이나 기법을 정의하는데 사용하는 데이터 언어이다. 사용자는 데이터베이스를 올바르게 관리하기 위해 필요한 규칙과 기법을 데이터 제어어를 이용해 데이터베이스 관리 시스템에 설명한다. 그러면 데이터베이스 관리 시스템이 이 규칙과 기법에 따라 데이터베이스를 제어하고 보호한다.

- 무결성: 데이터베이스에 정확하고 유효한 데이터만 유지한다.

- 보안: 허가받지 않은 사용자가 데이터에 접근하는 것을 차단하거나, 허가된 사용자가 접근 구너한이 있는 데이터에만 접근할 수 있게 한다.

- 회복: 장애가 발생해도 데이터의 일관성을 유지한다.

- 동시성: 여러 사용자가 같은 데이터에 동시에 접근하여 처리할 수 있게한다.

## 데이터베이스 관리 시스템의 구성

데이터 베이스를 관리하고 사용자의 데이터 처리 요구를 수행하는 데이터베이스 관리 시스템은 데이터베이스 시스템의 주요 구성 요소이다. 사용자와 데이터베이스 사이에 위치하며, 기능에 따라 크게 질의 처리기와 저장 데이터 관리자로 구분할 수 있다.

**질의 처리기**
사용자의 데이터 처리 요구를 해석하여 처리하는 역할을 담당한다.

- DDL 컴파일러: 데이터 정의어로 작성된 스키마의 정의를 해석한다. 그리고 저장 데이터 관리자의 도움을 받아 새로운 데이터베이스를 구축하고 스키마의 정의를 데이터사전에 저장한다. 데이터 정의어로 작성된 기존 스키마의 삭제나 수정 요청도 처리하며, 변경된 내용을 데이터 사전에 적용한다.

- DML 프리 컴파일러: 응용 프로그램에 삽입된 데이터 조작어를 추출하여 DML컴파일러에게 전달한다. 단 데이터 조작어와 관련없는 나머지 코드들은 해당 언어의컴파일러에 보내진다.

- DML 컴파일러: 데이터 조작어로 작성된 데이터 처리 요구를 분석하여 런타임 데이터베이스 처리기가 이해할 수 있도록 해석한다.

- 런타임 데이터베이스 처리기: 저장 데이터 관리자를 통해 데이터베이스에 접근하여, DML 컴파일러로 부터 전달받은 데이터 처리 요구를 데이터베이스에서 실제로 실행한다.

- 트랜잭션 관리자: 데이터베이스에 접근하는 과정에서 사용자의 접근 권한이 유효한지를 검사하고, 데이터베이스 무결성을 유지하기 위한 제약 조건 위반 여부를 확인한다. 회복이나 병행 수행과 관련된 작업도 담당한다.

**저장 데이터 관리자**
저장 데이터 관리자는 디스크에 저장된 데이터베이스와 데이터 사전을 관리하고 여기에 실제로 접근하는 역할을 담당한다. 그런데 디스크에 저장된 데이터에 접근하는 것은 운영체제의 기본 기능이므로 저장 데이터 관리자는 운영체제의 도움을 받아 데이터베이스에 대한 접근을 수행한다.
